% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/reef-set_params.R
\name{setRefuge}
\alias{setRefuge}
\title{Set the refuge profile parameters}
\usage{
setRefuge(
  params,
  method,
  w_settle = NULL,
  max_protect = NULL,
  tau = NULL,
  method_params,
  refuge_user = NULL,
  bad_predator = NULL,
  ...
)
}
\arguments{
\item{params}{MizerParams object}

\item{method}{The desired method for setting up benthic refuge,
can be "sigmoidal", "binned", or "competitive"}

\item{w_settle}{The body weight (g) at which fish settle onto the reef.
Fish smaller than this are considered to be larval and
thus too small to use predation refuge}

\item{max_protect}{The maximum proportion of fish (any size class)
protected by refuge}

\item{tau}{The proportion of fish with access to refuge that actually use it}

\item{method_params}{A data frame containing values specific to each
method for calculating refuge}

\item{refuge_user}{A vector of logical values indicating whether each
functional group uses refuge, TRUE indicates the group uses refuge while
false indicates that they do not. Alternatively, these can be included in
the \code{params@species_params} data frame.}

\item{bad_predator}{A vector of logical values indicating whether hunting is
inhibited by refuge for this functional group. FALSE indicates that this
species is able to encounter prey within refuge (e.g. eels). Alternatively,
these can also be included in the \code{params@species_params} data frame.

Optional parameters:}
}
\value{
\code{setRefuge}: A MizerParams object with updated refuge parameters
}
\description{
Checks if given refuge parameters are valid and then stores them in the
mizerParams object
}
\section{Setting the refuge profile}{


Refuge profiles account for the protective behavior of prey living in
high complexity environments (e.g. coral reefs) with access to predation
refuge. The refuge profile defines the proportion of fish within
user-defined length bins that are protected from being encountered
by a predator.

A unique refuge profile is generated for each predator group x
prey group x prey size combination based on the given refuge profile
parameters as well as four values from \code{params@species_params}: length
to weight conversion values \code{a} and \code{b}, \code{refuge_user}, which is true
for groups utilize that predation refuge, and \code{bad_pred}, which is false
for predator groups whose body shape or predatory strategy allow them to
access fish within refuge (e.g. eels).

To ensure some food is always available to predators, the maximum
proportion of fish protected by refuge in any size class is set by
\code{max_protect}.

The refuge profile is used when calculating the food encounter rate in
\code{\link[=reefEncounter]{reefEncounter()}} and the predation mortality rate in \code{\link[=reefPredMort]{reefPredMort()}}.
Its entries are dimensionless values between 0 and 1 which represent the
proportion of fish in the corresponding prey and size categories that are
hidden within refuge and thus cannot be encountered by predators. If no
refuge is available then predator-prey interactions are determined
entirely by size-preference.

The mizerReef package provides three methods to define the refuge profile:

\if{html}{\out{<div class="sourceCode">}}\preformatted{ 1.``sigmoidal`` - This method is preferred for data-poor reefs or reefs
 where the refuge distribution is unknown. It is also ideal for systems
 where only one functional group is expected to be utilizing refuge. The
 proportion of fish with access to refuge \eqn{ R_j(w_p) }$ is given by:

 \deqn{ R_j(w_p) =
         \frac{r}{1 + e^{\left(\alpha (w - W_{refuge})\right)}}}
     \{R_j(w_p) = r_\{peak\}/(1 + e^\{(\\alpha (w - W_\{refuge\}))\}\}
     
 Here \eqn{W_{refuge}} marks the body weight at which refuge becomes 
 scarcer for prey. \eqn{r} defines the maximum proportion of fish with
 access to predation refuge and is always less than or equal to
 `max_protect`. \eqn{\alpha} controls the rate at which the 
 availability of refuge decreases with increasing body size. It
 defaults to a steep slope of 100.

 For this method, `method_params` should contain columns named
 `prop_protect` and `L_refuge` that give the values for \eqn{r}
 and the length at which refuge becomes scarce in cm.

 2. ``binned`` - This method is appropriate for theoretical applications
 and does not rely on empirical data. It sets refuge to a constant
 proportion of fish within a given size range. The  proportion of fish
 in group \eqn{j} with access to refuge is given by:

 \deqn{ R_j(w_p) = r_k ~~~~~~~ w_p ∈ (~w_{k-1}, w_k~] }
     \{R_j(w_p) = r_k ~~~~~~~ w_p ∈ (~w_\{k-1\}, w_k~]

 where \eqn{r_k} is the proportion of fish with access to refuge in
 size class \eqn{k}.

 For this method, `method_params` should contain columns named
 `start_L`and `end_L` which contain the starting and ending lengths [cm]
 of each size bin and `prop_protect`, the proportion of fish protected
 within each corresponding size bin.

 3. ``competitive`` - This method is appropriate when refuge density 
 data is available for the modelled reef. The refuge density describes 
 the distribution of refuges \eqn{(#/m^2)} across defined fish body size
 categories. The proportion of fish in size class \eqn{k} with access 
 to refuge is given by:

 \deqn{R_j(w_p) = \tau\cdot\frac{\eta_k}{\sum_{i}\int_{w_{k-1}}^{w_k}
     N_i(w)~dw}  ~~~~~~~ w_p ∈ (~w_{k-1}, w_k~]}
     \{R_j(w_p) = \\tau \\eta_k/(\\sum_\{i\}\\int_\{w_\{k-1\}\}^\{w_k\}
 N_i(w)~dw)  ~~~~~~~ w_p ∈ (~w_\{k-1\}, w_k~]\}

 where \eqn{\tau} is the proportion of fish with access to refuge that
 are expected to actually utilize  it, \eqn{\eta_k} is the density of
 refuges in size range \eqn{(w_{k-1}, w_k]} and
  \eqn{\sum_{i}\int_{w_{k-1}}^{w_k} N_i(w)~dw} gives the density
  of fish from any group in size range \eqn{(w_{k-1}, w_k]}.
 This represents the density of competitors for refuges in
 size class \eqn{k}.

 For this method, `method_params` should contain columns named
 `start_L`and `end_L` which contain the starting and ending lengths [cm]
 of each size bin and `refuge_density`, the number of refuges available
 in each size bin [no/m^2].
}\if{html}{\out{</div>}}

This function checks that the supplied refuge parameters are valid, adds
relevant columns to the \code{species_params} data frame, and stores refuge
parameters in the \code{other_params} slot of the \code{params} object.

Refuge profile parameters can be input in a spreadsheet program and saved
as a .csv file. The data can then be read into R using the command
\code{read.csv()}.
}

\seealso{
Other functions for setting parameters: 
\code{\link{setExtMortParams}()},
\code{\link{setURParams}()}
}
\concept{functions for setting parameters}
